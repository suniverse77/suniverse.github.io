---
layout: single
title: "[Pandas] 데이터 처리"
last_modified_at: 2025-08-19
categories: ["파이썬"]
tags: ["Pandas"]
excerpt: "drop / replace / astype / fillna / interpolate / dropna"
use_math: true
toc: true
toc_sticky: true
---

<details>
<summary><font color='#3219ecff'>**사용할 데이터셋**</font></summary>
<div markdown="1">

```
    city  avg_temp  rainfall  humidity
0  Seoul      28.5       5.2      75.0
1    NaN      29.1       0.0      70.0
2  Seoul      27.8      12.5      80.0
3  Busan       NaN       3.1      72.0
4   Jeju      26.7      25.4      85.0
5  Seoul      27.5       0.8      78.0
6  Busan      28.8       1.5      73.0
7   Jeju      26.5      22.0      88.0
8    NaN       NaN       NaN       NaN
9  Seoul      29.3       0.0      68.0
```

</div>
</details>
<br>

## 1. 데이터 추가

```python
# 'humidity2'라는 새로운 column 생성
df['humidity2'] = df['humidity'] * 2
```

<details>
<summary><font color='#F28500'>실행 결과</font></summary>
<div markdown="1">

```
    city  avg_temp  rainfall  humidity  humidity2
0  Seoul      28.5       5.2      75.0      150.0
1    NaN      29.1       0.0      70.0      140.0
2  Seoul      27.8      12.5      80.0      160.0
3  Busan       NaN       3.1      72.0      144.0
4   Jeju      26.7      25.4      85.0      170.0
5  Seoul      27.5       0.8      78.0      156.0
6  Busan      28.8       1.5      73.0      146.0
7   Jeju      26.5      22.0      88.0      176.0
8    NaN       NaN       NaN       NaN        NaN
9  Seoul      29.3       0.0      68.0      136.0
```

</div>
</details>
<br>

## 2. 데이터 제거

- `drop()` : 특정 row/column을 제거

```python
# 'humidity'열 제거 (axis=1)
df['humidity'] = df.drop('humidity', axis=1)

# 1행 제거 (axis=0)
df = df.drop(7, axis=0)
```

```python
# inplace 연산 가능
df.drop('humidity', axis=1, inplace=True)
df.drop(7, axis=0, inplace=True)
```

<details>
<summary><font color='#F28500'>실행 결과</font></summary>
<div markdown="1">

```
    city  avg_temp  rainfall
0  Seoul      28.5       5.2
1    NaN      29.1       0.0
2  Seoul      27.8      12.5
3  Busan       NaN       3.1
4   Jeju      26.7      25.4
5  Seoul      27.5       0.8
6  Busan      28.8       1.5
8    NaN       NaN       NaN
9  Seoul      29.3       0.0
```

</div>
</details>
<br>

## 3. 데이터 변환

- `replace()` : 
- `astype()` : 특정 column의 dtype을 변환

```python
df.replace(, inplace=True/False)
```

<details>
<summary><font color='#F28500'>실행 결과</font></summary>
<div markdown="1">

```

```

</div>
</details>
<br>

```python
# 직접 열에 할당해야 dtype이 변환됨 (NaN은 int로 변환 불가능)
df['humidity'] = df['humidity'].astype(float)
```

<details>
<summary><font color='#F28500'>실행 결과</font></summary>
<div markdown="1">

```
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 10 entries, 0 to 9
Data columns (total 4 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   city      8 non-null      object 
 1   avg_temp  8 non-null      float64
 2   rainfall  9 non-null      float64
 3   humidity  10 non-null     float64
dtypes: float64(3), object(1)
memory usage: 452.0+ bytes
```

</div>
</details>
<br>

## 4. 결측치 처리

- `N/A` : 데이터 없음
- `Null` : 타입은 있지만 값이 없음
- `NaN` : 숫자 타입인데 수학적으로 유효한 숫자가 아님 (`sqrt(-1)`, `0/0`)

### (1) 결측치 채우기

- `fillna()` : 여러가지 방법으로 결측치를 채움
- `interpolate()` : 앞뒤 값을 이용해 결측치를 보간함 (연속형 변수에만 적용 가능)

```python
# 결측치를 특정 값으로 채움
df['humidity'] = df['humidity'].fillna(15)
df['city'] = df['city'].fillna('Seoul')
```

```python
# inplace 연산 가능
df['humidity'].fillna(15, inplace=True)
df['city'].fillna('Seoul', inplace=True)
```

<details>
<summary><font color='#F28500'>실행 결과</font></summary>
<div markdown="1">

```
    city  avg_temp  rainfall  humidity
0  Seoul      28.5       5.2      75.0
1  Seoul      29.1       0.0      70.0
2  Seoul      27.8      12.5      80.0
3  Busan       NaN       3.1      72.0
4   Jeju      26.7      25.4      85.0
5  Seoul      27.5       0.8      78.0
6  Busan      28.8       1.5      73.0
7   Jeju      26.5      22.0      88.0
8  Seoul       NaN       NaN      15.0
9  Seoul      29.3       0.0      68.0
```

</div>
</details>
<br>

```python
# 결측치를 뒤 행의 값으로 채움
df = df.fillna(method='backfill')
```

```python
# inplace 연산 가능
df.fillna(method='backfill', inplace=True)
```

<details>
<summary><font color='#F28500'>실행 결과</font></summary>
<div markdown="1">

```
    city  avg_temp  rainfall  humidity
0  Seoul      28.5       5.2      75.0
1  Seoul      29.1       0.0      70.0
2  Seoul      27.8      12.5      80.0
3  Busan      26.7       3.1      72.0
4   Jeju      26.7      25.4      85.0
5  Seoul      27.5       0.8      78.0
6  Busan      28.8       1.5      73.0
7   Jeju      26.5      22.0      88.0
8  Seoul      29.3       0.0      68.0
9  Seoul      29.3       0.0      68.0
```

</div>
</details>
<br>

```python
# 결측치를 앞 행의 값으로 채움
df = df.fillna(method='ffill')
```

```python
# inplace 연산 가능
df.fillna(method='ffill', inplace=True)
```

<details>
<summary><font color='#F28500'>실행 결과</font></summary>
<div markdown="1">

```
    city  avg_temp  rainfall  humidity
0  Seoul      28.5       5.2      75.0
1  Seoul      29.1       0.0      70.0
2  Seoul      27.8      12.5      80.0
3  Busan      27.8       3.1      72.0
4   Jeju      26.7      25.4      85.0
5  Seoul      27.5       0.8      78.0
6  Busan      28.8       1.5      73.0
7   Jeju      26.5      22.0      88.0
8   Jeju      26.5      22.0      88.0
9  Seoul      29.3       0.0      68.0
```

</div>
</details>
<br>

```python
# 연속형 column의 결측치를 해당 column의 평균값으로 채움 (평균값 외에 .median() / .max() 존재)
df['humidity'].fillna(df['humidity'].mean(), inplace=True)
```

<details>
<summary><font color='#F28500'>실행 결과</font></summary>
<div markdown="1">

```
    city  avg_temp  rainfall   humidity
0  Seoul      28.5       5.2  75.000000
1    NaN      29.1       0.0  70.000000
2  Seoul      27.8      12.5  80.000000
3  Busan       NaN       3.1  72.000000
4   Jeju      26.7      25.4  85.000000
5  Seoul      27.5       0.8  78.000000
6  Busan      28.8       1.5  73.000000
7   Jeju      26.5      22.0  88.000000
8    NaN       NaN       NaN  76.555556
9  Seoul      29.3       0.0  68.000000
```

</div>
</details>
<br>

### (2) 결측치 제거하기

- `dropna()` : 

```python
# 결측치가 1개라도 있는 row를 제거
df.dropna()

# 모든 값이 결측치인 row만 제거
df.dropna(how='all')

# 특정 column에 결측치가 있는 row만 제거
df.dropna(subset=[''])
```
