---
layout: single
title: "[논문리뷰] Score-Based Generative Modeling through Stochastic Differential Equations"
last_modified_at: 2025-03-13
categories: ["논문리뷰"]
tags: ["Image Generation"]
excerpt: "ICLR 2021"
use_math: true
toc: true
toc_sticky: true
---

> [[Paper]](https://arxiv.org/abs/2011.13456)
>
> ICLR 2021

## Introduction

**제안하는 방법**

스코어 기반 생성 모델의 새로운 샘플링 방법을 가능하게 하고 그 능력을 확장하기 위해, 기존 접근 방식을 확률 미분 방정식(SDE) 관점에서 일반화하는 통합 프레임워크를 제안한다.

- DDPM과 같은 기존 방식처럼 유한한 단계의 time step을 사용하는 대신, 연속 시간 확률 과정으로 일반화한다.
    - 주어진 forward SDE를 따라 데이터 포인트를 점차 무작위 노이즈로 변형시킨다. 이 SDE는 데이터에 의존하지 않으며, 학습 가능한 파라미터도 없다.
    - Forward SDE에 대응되는 reverse SDE가 존재하며, 이 역과정을 통해 노이즈로부터 데이터 생성이 가능하다.
    - 하지만 reverse SDE를 직접 알 수 없기 때문에, 스코어 함수 $\nabla_{\mathbf{x}}\log p()$를 예측하는 뉴럴 네트워크를 학습시켜 이를 근사한다. 
    - 학습된 스코어 함수로 reverse SDE가 정의되면, Euler-Maruyama와 같은 SDE solver를 통해 데이터를 샘플링한다.

<details>
<summary><font color='purple'>SDE (Stochastic Differential Equation)</font></summary>
<div markdown="1">

ODE의 목적은 원래 함수를 모를 때, 도함수와 함수값을 이용해서 원래 함수를 추정하거나 현재 관측하지 않은 변수에서의 함수값을 추정하는 것이다.

$$
\underbrace{d\mathbf x=\mathbf f(\mathbf x,t)dt}_{\text{ODE}}+\underbrace{g(t)d\mathbf w}_{\text{Randomness}}
$$

SDE는 ODE에서 무작위성 (Stochastic process)이 추가된 형태이다.

$f(\mathbf x,t)$, $g(t)$는 사전에 정의된 함수로 학습 파라미터가 없으며, 이 forward process는 입력 데이터와 무관하게 데이터를 무작위 노이즈로 바꾼다.

</div>
</details>

<center><img src='{{"/assets/images/논문리뷰/SDE-1.png" | relative_url}}' width=70%"></center>

제안한 프레임워크의 주요 기여는 아래와 같다.

**Flexible sampling and likelihood computation**

기존 DDPM이나 SMLD는 고정된 수치 방법(예: 단순 역방향 마르코프 체인)에 의존하여 정확한 log-likelihood 계산이 어렵거나 불가능했지만, 제안한 방법은 일반 SDE solver를 활용하여 reverse SDE를 적분함으로써 샘플을 생성할 수 있다.

특히 기존 SDE 방식에서는 불가능했던 두 가지 특수한 방법을 제안합니다:

1. Predictor-Corrector (PC) 샘플러: 수치적 SDE 솔버와 스코어 기반 MCMC(Langevin MCMC, HMC 등)를 결합.

2. 확률 흐름 ODE 기반의 결정론적 샘플링: SDE를 대응하는 ODE로 변환하면, 결정론적 샘플링이 가능해짐 빠더 빠르고 정밀한 샘플링 가능

**잠재 공간(latent code)**에서 의미 있는 조작 가능 (예: 스타일 편집, 인터폴레이션)

샘플을 유일하게 인코딩 가능

정확한 우도(log-likelihood) 계산 가능 → 평가 지표로 사용 가능



**Controllable generation**

학습 시 사용되지 않았던 조건을 샘플링 단계에서 적용하여 조건부 생성, 이미지 인페인팅, 컬러 복원, 기타 역문제들을 별도의 재학습 없이 하나의 unconditional score-based 모델을 통해 model 해결할 수 있다.

**Unified framework**

다양한 SDE 설계를 실험하고 조정할 수 있는 공통적 접근 방식을 제공합니다.

기존의 SMLD와 DDPM은 이 프레임워크 내에서 각각 두 종류의 SDE를 **이산화(discretization)**한 특수 사례로 해석할 수 있습니다.

DDPM이 SMLD보다 우수한 샘플 품질을 보였다는 최근 보고와 달리, 우리는 더 나은 아키텍처와 샘플링 알고리즘을 통해 SMLD 역시 최신 성능을 달성할 수 있음을 보입니다.

## Methods

