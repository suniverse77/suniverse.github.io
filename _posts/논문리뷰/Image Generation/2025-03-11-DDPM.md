---
layout: single
title: "[논문리뷰] Denoising Diffusion Probabilistic Models"
last_modified_at: 2025-03-11
categories: ["논문리뷰"]
tags: ["Image Generation"]
excerpt: "NeurIPS 2020"
use_math: true
toc: true
toc_sticky: true
---

**NeurIPS 2020** 
[[Paper]](https://arxiv.org/abs/2006.11239)

## Introduction

본 논문에서는 diffusion probabilistic model(이하 diffusion model)의 발전을 다룬다.

Diffusion model은 유한한 시간 후 데이터와 일치하는 샘플을 생성하도록 변분 추론(variational inference)을 통해 학습되는 매개변수화된 마르코프 체인입니다.

## Methods

### 1. Forward process

Forward process는 variance schedule $\beta_1,\dots,\beta_T$에 따라 입력 데이터 $\mathbf{x}_0$에 gaussian noise를 점진적으로 더하여 최종적으로 완전한 노이즈 이미지 $N(0,\text{I})$로 만드는 과정이다.

VAE와 달리 latent와 data의 차원이 같으므로, $\mathbf{z}$를 $\mathbf{x}$로 표현한다.

$$
q(\mathbf x_{1:T}\mid\mathbf x_0):=\prod_{t=1}^Tq(\mathbf x_t\mid\mathbf x_{t-1})
$$

위의 수식은 forward process를 표현한 것으로, Markov chain으로 정의된다.

$$
q(\mathbf x_t\mid\mathbf x_{t-1}):=
\mathcal{N}(\mathbf x_t;\sqrt{1-\beta_t}\mathbf x_{t-1},\beta_t\mathbf I)
$$

위의 수식은 가우시안 분포로 정의된 forward process의 한 단계이다.

이전 step의 이미지의 값을 $\sqrt{1-\beta_t}$만큼 스케일링한 후, 분산이 $\beta_t\mathbf{I}$인 가우시안 노이즈를 더한다.

---

원본 데이터 $\mathbf{x}_0$에서 임의의 time step $t$까지 한 번에 이동할 수 있는 수식이 아래와 같이 closed form으로 존재한다. (실제 코드에서는 아래의 수식을 사용해 forward process 진행)

$$
q(\mathbf x_t\mid\mathbf x_0)=\mathcal{N}(\mathbf x_t;\sqrt{\bar\alpha_t}\mathbf x_0,(1-\bar\alpha_t)\mathbf I)
$$

$$
\alpha_t:=1-\beta_t~,~\bar\alpha_t:=\prod_{s=1}^t\alpha_s
$$

하지만 확률 변수에서 직접 샘플링하는 과정은 미분이 불가능하므로, 역전파를 위해 reparameterization trick을 사용해 아래와 같이 변형한다.

$$
\mathbf
x_t=\sqrt{\bar{\alpha}_t}\mathbf x_0+\sqrt{(1-\bar{\alpha}_t)}\boldsymbol\epsilon
~,~
\boldsymbol\epsilon \sim \mathcal N(\mathbf0,\textbf{I})
$$

#### Variance scheduler

time step $t$에 따라 추가되는 노이즈의 분산을 조절하는 매커니즘으로, 스케줄 파라미터 $\beta_t$를 통해 정의한다.

- 초기 단계($t$가 작을 때): 데이터의 구조와 특성을 최대한 보존하기 위해 작은 분산의 노이즈를 추가한다. → $\beta_t$가 작음
- 후반 단계($t$가 클 때): 데이터가 이미 상당히 노이즈화되어 있으므로, 빠른 확산과 수렴을 위해 더 큰 분산의 노이즈를 추가한다. → $\beta_t$가 큼
- 대표적인 스케줄링 방식으로는 Linear schedule, Cosine schedule 등이 사용된다.

### 2. Reverse process



## Experiments
